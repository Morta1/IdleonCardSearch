"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7896],{47212:function(l,o,e){e.d(o,{q5:function(){return i},ZX:function(){return getBuildCost},VR:function(){return getConstruction},Bt:function(){return getExtraMaxLevels},d4:function(){return getTowers},ai:function(){return optimizeArrayWithSwaps}});var n=e(42168),t=e(70473);let createCogstructionData=(l,o)=>{let e=null==l?void 0:l.reduce((l,e,n)=>{let t=getCogstructionCogType(o[n]);if(!t)return l;let{a:i="",c:u="",d="",b:r="",e:a="",g:v="",k:s="",f:c=""}=e||{},g=[i,u,d,r,a,v,s,c].map((l,o)=>o<7?"".concat(getCogstructionValue(l)||"",","):getCogstructionValue(l)),f=o[n].includes("Player_")?o[n].split("Player_")[1]:"";return"".concat(l,"\n").concat(t,",").concat(f,",").concat(g.join(""))},"cog type,name,build_rate,flaggy_rate,exp_mult,exp_rate,build_rate_boost,flaggy_rate_boost,flaggy_speed,exp_rate_boost"),n="empties_x,empties_y",t=null==o?void 0:o.slice(0,96);for(let l=0;l<8;l++)for(let o=0;o<12;o++){let e=(7-l)*12+o;"Blank"===t[e]&&(n="".concat(n,"\n").concat(o,",").concat(l))}return{cogData:e,empties:n}},getCogstructionCogType=l=>{if("Blank"===l)return null;if(l.includes("Player_"))return"Character";if("CogY"===l)return"Yang_Cog";if("CogZ"===l)return"Omni_Cog";let o=Object.entries({ad:"Plus",di:"X",up:"Up",do:"Down",ri:"Right",le:"Left",ro:"Row",co:"Col",cr:"Omni"}).find(o=>{let[e]=o;return l.endsWith(e)});return o?"".concat(o[1],"_Cog"):"Cog"},getCogstructionValue=l=>{var o;return(null==l?void 0:null===(o=l.name)||void 0===o?void 0:o.includes("%"))?(null==l?void 0:l.value)>0&&!isNaN((null==l?void 0:l.value)/100)?(null==l?void 0:l.value)/100:"":(null==l?void 0:l.value)||""},getConstruction=(l,o)=>{let e=(null==l?void 0:l.CogMap)||(0,n.tryToParse)(null==l?void 0:l.CogM),t=(null==l?void 0:l.CogOrder)||(0,n.tryToParse)(null==l?void 0:l.CogO),i=createCogMap(e,null==t?void 0:t.length),u=parseConstruction(i),d=getFlags(l,u,t,o),r=createCogstructionData(u,t);return{...d,cogstruction:r}},getFlags=(l,o,e,t)=>{let i=(null==l?void 0:l.FlagUnlock)||(0,n.tryToParse)(null==l?void 0:l.FlagU),u=(null==l?void 0:l.FlagsPlaced)||(0,n.tryToParse)(null==l?void 0:l.FlagP);return parseFlags(i,u,o,e,t)},parseConstruction=l=>null==l?void 0:l.map(l=>{var o;return null===(o=Object.entries(l))||void 0===o?void 0:o.reduce((l,o)=>{let[e,n]=o;return(null===t.cogKeyMap||void 0===t.cogKeyMap?void 0:t.cogKeyMap[e])&&(null===t.cogKeyMap||void 0===t.cogKeyMap?void 0:t.cogKeyMap[e])!=="_"?{...l,[e]:{name:null===t.cogKeyMap||void 0===t.cogKeyMap?void 0:t.cogKeyMap[e],value:n}}:{...l,[e]:n}},{})}),createCogMap=(l,o)=>{let e=[];for(let n=0;n<o;n++)e[n]=(null==l?void 0:l[n])||{};return e},parseFlags=(l,o,e,n,i)=>{var u,d;let r=null==l?void 0:l.reduce((l,i,u)=>{let d=null==n?void 0:n[u],r=null==e?void 0:e[u];return[...l,{currentAmount:-11===i?null===t.flagsReqs||void 0===t.flagsReqs?void 0:t.flagsReqs[u]:parseFloat(i),requiredAmount:null===t.flagsReqs||void 0===t.flagsReqs?void 0:t.flagsReqs[u],flagPlaced:null==o?void 0:o.includes(u),cog:{name:d,stats:r,originalIndex:u}}]},[]),a=null!==(d=null==i?void 0:null===(u=i.gemShopPurchases)||void 0===u?void 0:u.find((l,o)=>118===o))&&void 0!==d?d:0,v=null==e?void 0:e.map((l,o)=>({...l,name:null==n?void 0:n[o]})).filter(l=>{let{name:o}=l;return null==o?void 0:o.includes("Player_")}).reduce((l,o)=>{let{a:e}=o;return l+((null==e?void 0:e.value)||0)},0),s=evaluateBoard(r);return{...s,baseBoard:r,totalFlaggyRate:(null==s?void 0:s.totalFlaggyRate)*(1+50*a/100),playersBuildRate:v}},swapElements=(l,o,e)=>{var n,t;let i=[...l],u={...null===(n=i[o])||void 0===n?void 0:n.cog};return i[o]={...i[o],cog:{...null===(t=i[e])||void 0===t?void 0:t.cog}},i[e]={...i[e],cog:u},i},optimizeArrayWithSwaps=function(l,o){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2500,n=arguments.length>3?arguments[3]:void 0,t=[...l],i=evaluateBoard(t,n),u=null==i?void 0:i[o],d=[],r=Date.now();for(;Date.now()-r<e;){var a,v,s,c,g,f,p,h,y,m,M,C;let l=Math.floor(Math.random()*t.length),e=Math.floor(Math.random()*t.length);if(l===e||(null==t?void 0:null===(a=t[l])||void 0===a?void 0:a.currentAmount)<(null==t?void 0:null===(v=t[l])||void 0===v?void 0:v.requiredAmount)||(null==t?void 0:null===(s=t[e])||void 0===s?void 0:s.currentAmount)<(null==t?void 0:null===(c=t[e])||void 0===c?void 0:c.requiredAmount)||(null==t?void 0:null===(g=t[l])||void 0===g?void 0:g.flagPlaced)||(null==t?void 0:null===(h=t[l])||void 0===h?void 0:null===(p=h.cog)||void 0===p?void 0:null===(f=p.stats)||void 0===f?void 0:f.h)==="everything"||(null==t?void 0:null===(y=t[e])||void 0===y?void 0:y.flagPlaced)||(null==t?void 0:null===(C=t[e])||void 0===C?void 0:null===(M=C.cog)||void 0===M?void 0:null===(m=M.stats)||void 0===m?void 0:m.h)==="everything")continue;let r=swapElements(t,l,e),b=evaluateBoard(r,n);(null==b?void 0:b[o])>u&&(i=b,t=r,u=null==b?void 0:b[o],d=[...d,{from:l,to:e}])}return{...i,moves:d}},evaluateBoard=(l,o)=>{let{boosted:e}=getAllBoostedCogs(l),n=0,t=0,i=0,u=0,d=null==l?void 0:l.map((l,d)=>{var r,a,v,s,c,g,f,p,h,y,m,M;let{cog:C}=l||{},{e:b,g:_,f:w}=(null==e?void 0:e[d])||{},q=(null==C?void 0:null===(a=C.stats)||void 0===a?void 0:null===(r=a.a)||void 0===r?void 0:r.value)||0,x=(null==C?void 0:null===(s=C.stats)||void 0===s?void 0:null===(v=s.c)||void 0===v?void 0:v.value)||0,P=(null==C?void 0:null===(g=C.stats)||void 0===g?void 0:null===(c=g.b)||void 0===c?void 0:c.value)||0,R=0;if(null==C?void 0:null===(f=C.name)||void 0===f?void 0:f.includes("Player_")){let l=null==o?void 0:o.find(l=>{let{name:o}=l;return o===(null==C?void 0:C.name.replace("Player_",""))});l?(R=(null==l?void 0:l.constructionExpPerHour)*(1+((null==w?void 0:w.value)||0)/100),u+=R):u+=P}let B=q*(1+((null==b?void 0:b.value)||0)/100);n+=Math.max(B,0),t+=(null==C?void 0:null===(h=C.stats)||void 0===h?void 0:null===(p=h.d)||void 0===p?void 0:p.value)||0;let k=x+x*((null==_?void 0:_.value)||0)/100;return i+=Math.max(k,0),{...l,cog:{...C,stats:{...null==C?void 0:C.stats,a:{...null==C?void 0:null===(y=C.stats)||void 0===y?void 0:y.a,value:B},c:{...null==C?void 0:null===(m=C.stats)||void 0===m?void 0:m.c,value:k},...o?{b:{...null==C?void 0:null===(M=C.stats)||void 0===M?void 0:M.b,value:R}}:{}}}}});return o&&(d=null==d?void 0:d.map(l=>{var o,e,n,i,u,d,r,a;return(null==l?void 0:null===(e=l.cog)||void 0===e?void 0:null===(o=e.name)||void 0===o?void 0:o.includes("Player_"))?{...l,cog:{...null==l?void 0:l.cog,stats:{...null==l?void 0:null===(n=l.cog)||void 0===n?void 0:n.stats,b:{...null==l?void 0:null===(u=l.cog)||void 0===u?void 0:null===(i=u.stats)||void 0===i?void 0:i.b,value:(null==l?void 0:null===(a=l.cog)||void 0===a?void 0:null===(r=a.stats)||void 0===r?void 0:null===(d=r.b)||void 0===d?void 0:d.value)*(1+t/100)}}}}:l})),{totalBuildRate:n,totalExpRate:t,totalFlaggyRate:i,totalPlayerExpRate:u*(o?1+t/100:1),board:d}},getAllBoostedCogs=l=>{let o={},e=Array(96).fill(0);for(let d=0;d<8;d++)for(let r=0;r<12;r++){var n,t,i,u;let a=(7-d)*12+r,v=null==l?void 0:null===(n=l[a])||void 0===n?void 0:n.cog,s=(null==l?void 0:null===(i=l[a])||void 0===i?void 0:null===(t=i.cog)||void 0===t?void 0:t.stats)||{},c=getAffectedIndexes(v,r,d);if((null==c?void 0:c.length)>0){c=null==c?void 0:null===(u=c.map(l=>{let[o,e]=l;return o<0||e<0||o>=12||e>=8?null:(7-e)*12+o}))||void 0===u?void 0:u.filter(l=>null!==l);let{e:l,f:n,g:t}=s||{};if(l||n||t)for(let l=0;l<c.length;l++){let n=c[l],{e:t,f:i,g:u}=s;if((null==e?void 0:e[n])===0)e[n]={e:{...t,value:Math.ceil(null==t?void 0:t.value)},f:{...i,value:Math.ceil(null==i?void 0:i.value)},g:{...u,value:Math.ceil(null==u?void 0:u.value)}};else{let{e:l,f:o,g:d}=e[n]||{};e[n]={e:{...l,value:Math.ceil(((null==l?void 0:l.value)||0)+((null==t?void 0:t.value)||0))},f:{...o,value:Math.ceil(((null==o?void 0:o.value)||0)+((null==i?void 0:i.value)||0))},g:{...d,value:Math.ceil(((null==d?void 0:d.value)||0)+((null==u?void 0:u.value)||0))}}}o[n]=[...o[n]||[],a]}}}return{boosted:e,relations:o}},getAffectedIndexes=(l,o,e)=>{var n;let t=[];switch(null==l?void 0:null===(n=l.stats)||void 0===n?void 0:n.h){case"diagonal":t.push([o-1,e-1],[o+1,e-1],[o-1,e+1],[o+1,e+1]);break;case"adjacent":t.push([o-1,e],[o,e+1],[o+1,e],[o,e-1]);break;case"up":t.push([o-1,e+2],[o,e+2],[o+1,e+2],[o-1,e+1],[o,e+1],[o+1,e+1]);break;case"right":t.push([o+2,e-1],[o+2,e],[o+2,e+1],[o+1,e-1],[o+1,e],[o+1,e+1]);break;case"down":t.push([o-1,e-2],[o,e-2],[o+1,e-2],[o-1,e-1],[o,e-1],[o+1,e-1]);break;case"left":t.push([o-2,e-1],[o-2,e],[o-2,e+1],[o-1,e-1],[o-1,e],[o-1,e+1]);break;case"row":for(let l=0;l<12;l++)o!==l&&t.push([l,e]);break;case"column":for(let l=0;l<8;l++)e!==l&&t.push([o,l]);break;case"corners":t.push([o-2,e-2],[o+2,e-2],[o-2,e+2],[o+2,e+2]);break;case"around":t.push([o,e-2],[o-1,e-1],[o,e-1],[o+1,e-1],[o-2,e],[o-1,e],[o+1,e],[o+2,e],[o-1,e+1],[o,e+1],[o+1,e+1],[o,e+2]);break;case"everything":for(let l=0;l<8;l++)for(let n=0;n<12;n++)(e!==l||o!==n)&&t.push([n,l])}return t},getTowers=l=>{let o=(null==l?void 0:l.TowerInfo)||(0,n.tryToParse)(null==l?void 0:l.Tower),e=(0,n.tryToParse)(null==l?void 0:l.TotemInfo)||(null==l?void 0:l.TotemInfo);return parseTowers(o,e)},parseTowers=(l,o)=>{var e;let n=null==o?void 0:o[0],i=null==n?void 0:n.reduce((l,o)=>l+o,0),u=Object.keys(t.towers).length,d=l.slice(54,62),r=0,a=0,v=null===(e=Object.entries(t.towers))||void 0===e?void 0:e.map(o=>{let[e,n]=o,t=null==l?void 0:l[null==n?void 0:n.index];return(null==n?void 0:n.index)>=9&&(null==n?void 0:n.index)<=17&&t>50&&(r+=t-50),a+=t,{...n,name:e,level:t,nextLevel:t+1===l[n.index+u],progress:null==l?void 0:l[(null==n?void 0:n.index)+12+2*u],inProgress:null==d?void 0:d.includes(null==n?void 0:n.index),slot:null==d?void 0:d.findIndex(l=>l===(null==n?void 0:n.index))}});return{data:v,buildMultiplier:null===t.randomList||void 0===t.randomList?void 0:t.randomList[13].split(" "),wizardOverLevels:r,totalLevels:a,totalWaves:i,towersTwo:null==l?void 0:l[2]}},getBuildCost=(l,o,e,n)=>{if(0===n)return 20*Math.pow(o+1,2)*Math.pow(1.6,o+1);{var t;let i=Number(null==l?void 0:null===(t=l.buildMultiplier)||void 0===t?void 0:t[n]);return i*Math.pow(e,o)}},i=[250,500,750,1e3,1250,1500,2500],getConstructionMasteryBonus=(l,o)=>6===o?l>=(null==i?void 0:i[6])?30:0:4===o?l>=(null==i?void 0:i[3])?100:0:5===o?l>=(null==i?void 0:i[5])?100:0:3===o&&l>=(null==i?void 0:i[1])?35:0,getExtraMaxLevels=(l,o,e)=>50===o?Math.round(2*e+getConstructionMasteryBonus(l,6,0)):101===o?getConstructionMasteryBonus(l,4,0):100===o?getConstructionMasteryBonus(l,5,0):15===o?getConstructionMasteryBonus(l,3,0):0},67896:function(l,o,e){e.d(o,{RB:function(){return isRiftBonusUnlocked},lC:function(){return getConstructMastery},wE:function(){return getRift}});var n=e(42168),t=e(70473),i=e(47212);let getRift=l=>{let o=(0,n.tryToParse)(null==l?void 0:l.Rift)||(null==l?void 0:l.Rift);return parseRift(o)},parseRift=l=>{let[o,e,n]=l||[];return{list:t.riftInfo,currentRift:parseInt(o),currentProgress:e,chars:n}},isRiftBonusUnlocked=(l,o)=>{var e;return null==l?void 0:null===(e=l.list)||void 0===e?void 0:e.find((e,n)=>{let{riftBonus:t}=e;return t===o&&n<=(null==l?void 0:l.currentRift)})},getConstructMastery=(l,o)=>"Ref Spd"===o?l>=(null===i.q5||void 0===i.q5?void 0:i.q5[0])?Math.floor(l/10):0:"Dmg"===o?l>=(null===i.q5||void 0===i.q5?void 0:i.q5[2])?2*Math.floor((l-(null===i.q5||void 0===i.q5?void 0:i.q5[2]))/10):0:"Build Spd"===o&&l>=(null===i.q5||void 0===i.q5?void 0:i.q5[4])?5*Math.floor((l-(null===i.q5||void 0===i.q5?void 0:i.q5[4]))/10):0}}]);