(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5053],{8364:function(e,l,t){"use strict";var n=t(64836);l.Z=void 0;var i=n(t(64938)),r=t(85893),o=(0,i.default)((0,r.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12 1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}),"DeleteForever");l.Z=o},74721:function(e,l,t){"use strict";var n=t(64836);l.Z=void 0;var i=n(t(64938)),r=t(85893),o=(0,i.default)((0,r.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"}),"Info");l.Z=o},2097:function(e,l,t){"use strict";var n=t(67294);l.Z=e=>{let l=n.useRef({});return n.useEffect(()=>{l.current=e}),l.current}},12281:function(e,l,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tools/material-tracker",function(){return t(72659)}])},72659:function(e,l,t){"use strict";t.r(l);var n=t(85893),i=t(67294),r=t(51233),o=t(417),u=t(15861),a=t(61903),d=t(30925),v=t(70473),s=t(83321),c=t(74721),m=t(5072),h=t(88344),p=t(23513),f=t(2962),y=t(8364),g=t(93946);l.default=()=>{var e;let{state:l}=(0,i.useContext)(p.I),[t,x]=(0,i.useState)(""),[w,N]=(0,i.useState)(""),[I,A]=(0,i.useState)(""),[j,S]=(0,i.useState)({}),[E,T]=(0,i.useState)(JSON.parse(localStorage.getItem("material-tracker"))||{}),b=(0,i.useMemo)(()=>v.itemsArray.filter(e=>{let{itemType:l}=e;return"Equip"!==l&&"Quest"!==l}),[]),C=(0,i.useMemo)(()=>(0,h.Nx)(null==l?void 0:l.characters,null==l?void 0:l.account),[null==l?void 0:l.characters,null==l?void 0:l.account]),[Z,k]=(0,i.useState)({material:!1,threshold:!1}),handleDeleteThreshold=e=>{let l={...E};delete l[e],T(l),S({}),localStorage.setItem("material-tracker",JSON.stringify(l))};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.PB,{title:"Idleon Toolbox | Material Tracker",description:"Add a material, set your own threshold and keep track of your inventory."}),(0,n.jsxs)(r.Z,{direction:"row",gap:3,alignItems:"center",flexWrap:"wrap",children:[(0,n.jsx)(o.Z,{id:"material tracker",value:t,onChange:(e,l)=>{x(l),k({...Z,material:!1})},autoComplete:!0,options:[t,...b],filterSelectedOptions:!0,getOptionLabel:e=>{var l;return(null==e?void 0:e.displayName)?null==e?void 0:null===(l=e.displayName)||void 0===l?void 0:l.replace(/_/g," "):""},renderOption:(e,l)=>{var t;return l?(0,i.createElement)(r.Z,{...e,key:e.id,gap:2,direction:"row",children:[(0,n.jsx)("img",{width:24,height:24,src:"".concat(d.prefix,"data/").concat(null==l?void 0:l.rawName,".png"),alt:""},"img-".concat(e.id)),(0,n.jsx)(u.Z,{children:null==l?void 0:null===(t=l.displayName)||void 0===t?void 0:t.replace(/_/g," ")},"text-".concat(e.id))]}):null},style:{width:300},renderInput:e=>(0,n.jsx)(a.Z,{...e,error:null==Z?void 0:Z.material,InputProps:{...e.InputProps,startAdornment:(null==t?void 0:t.rawName)?(0,n.jsx)("img",{width:24,height:24,src:"".concat(d.prefix,"data/").concat(null==t?void 0:t.rawName,".png")}):null},label:"Material name",variant:"outlined"})}),(0,n.jsx)(a.Z,{error:null==Z?void 0:Z.threshold,value:w,onChange:e=>{let{target:l}=e,t=l.value.replace(/,/g,"");N((0,d.numberWithCommas)(t)),k({...Z,threshold:!1})},label:"Threshold"}),(0,n.jsx)(a.Z,{value:I,onChange:e=>{let{target:l}=e;return A(l.value)},label:"Note"}),(0,n.jsx)(s.Z,{onClick:()=>{let e={};t||(e.material=!0);let l=null==w?void 0:w.replace(/,/g,"");if((!w||isNaN(l))&&(e.threshold=!0),(null==e?void 0:e.material)||(null==e?void 0:e.threshold)){k(e);return}let n={...E,[t.rawName]:{item:t,threshold:parseInt(l),note:I}};T(n),localStorage.setItem("material-tracker",JSON.stringify(n)),x(""),N(""),A("")},sx:{height:"fit-content"},variant:"contained",children:"Add threshold"})]}),(0,n.jsx)(r.Z,{direction:"row",gap:3,children:null===(e=Object.values(E))||void 0===e?void 0:e.map((e,l)=>{let{item:t,threshold:i,note:o}=e,{amount:a,owner:v}=(0,h.AN)(C,null==t?void 0:t.displayName),s,p=.02*i;return s=a<i?"error.light":a<=i+p?"warning.main":"success.main",(0,n.jsxs)(r.Z,{direction:"column",alignItems:"center",sx:{position:"relative"},onMouseEnter:()=>S({...j,[l]:!0}),onMouseLeave:()=>S({...j,[l]:!1}),children:[(null==j?void 0:j[l])?(0,n.jsx)(g.Z,{onClick:()=>handleDeleteThreshold(null==t?void 0:t.rawName),sx:{position:"absolute",left:-10},children:(0,n.jsx)(y.Z,{})}):null,(0,n.jsx)("img",{src:"".concat(d.prefix,"data/").concat(null==t?void 0:t.rawName,".png"),alt:""}),(0,n.jsxs)(r.Z,{direction:"row",gap:2,children:[(0,n.jsx)(u.Z,{children:(0,d.cleanUnderscore)(null==t?void 0:t.displayName)}),o?(0,n.jsx)(m.Z,{title:o,children:(0,n.jsx)(c.Z,{})}):null]}),(0,n.jsxs)(u.Z,{color:s,mt:1,children:[(0,d.notateNumber)(a),"/",(0,d.notateNumber)(i)]})]},"tracked-item-".concat(l))})})]})}},88344:function(e,l,t){"use strict";t.d(l,{AN:function(){return findQuantityOwned},F6:function(){return flattenCraftObject},Nx:function(){return getAllItems},QU:function(){return findItemInInventory},ju:function(){return calculateItemTotalAmount},t8:function(){return addStoneDataToEquip},tP:function(){return addEquippedItems},tT:function(){return createItemsWithUpgrades},w$:function(){return getAllTools},wA:function(){return findItemByDescriptionInInventory},zi:function(){return getStatsFromGear}});var n=t(70473);let addStoneDataToEquip=(e,l)=>{var t;return e&&l?null===(t=Object.keys(l))||void 0===t?void 0:t.reduce((t,n)=>{if("UQ1txt"===n||"UQ2txt"===n)return{...t,[n]:(null==e?void 0:e[n])||(null==l?void 0:l[n])};let i=null==e?void 0:e[n],r=null==l?void 0:l[n],o=i;return isNaN(r)||r<0?{...t,[n]:r}:(o=(i||0)+((null==l?void 0:l.UQ1txt)&&(null==e?void 0:e.Type)!=="KEYCHAIN"&&(null==e?void 0:e.UQ1txt)!==(null==l?void 0:l.UQ1txt)?0:r),{...t,[n]:parseFloat(o)})},{}):{}},calculateItemTotalAmount=function(e,l,t){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return null==e?void 0:e.reduce((e,i)=>{if(t)l===(n?null==i?void 0:i.rawName:null==i?void 0:i.name)&&(e+=null==i?void 0:i.amount);else{var r,o;(n?null==i?void 0:null===(r=i.rawName)||void 0===r?void 0:r.includes(l):null==i?void 0:null===(o=i.name)||void 0===o?void 0:o.includes(l))&&(e+=null==i?void 0:i.amount)}return e},0)},getStatsFromGear=(e,l,t)=>{var i,r,o,u,a,d,v,s,c,m,h,p;let{equipment:f}=e||{},y=null!==(m=null==t?void 0:null===(o=t.lab)||void 0===o?void 0:null===(r=o.playersChips)||void 0===r?void 0:null===(i=r[null==e?void 0:e.playerId])||void 0===i?void 0:i.find(e=>16===e.index))&&void 0!==m?m:0,g=null!==(h=null==t?void 0:null===(d=t.lab)||void 0===d?void 0:null===(a=d.playersChips)||void 0===a?void 0:null===(u=a[null==e?void 0:e.playerId])||void 0===u?void 0:u.find(e=>17===e.index))&&void 0!==h?h:0,x=null!==(p=null==t?void 0:null===(c=t.lab)||void 0===c?void 0:null===(s=c.playersChips)||void 0===s?void 0:null===(v=s[null==e?void 0:e.playerId])||void 0===v?void 0:v.find(e=>18===e.index))&&void 0!==p?p:0;return isNaN(l)?null==f?void 0:f.reduce((e,t)=>e+getStatFromEquipment(t,l),0):null==f?void 0:f.reduce((e,t,i)=>{var r;return e+getStatFromEquipment(t,null===n.bonuses||void 0===n.bonuses?void 0:null===(r=n.bonuses.etcBonuses)||void 0===r?void 0:r[l])*(3===i&&x||10===i&&y||9===i&&g?2:1)},0)},getStatFromEquipment=(e,l)=>{let t=(null==e?void 0:e.UQ1txt)===l?null==e?void 0:e.UQ1val:0,n=(null==e?void 0:e.UQ2txt)===l?null==e?void 0:e.UQ2val:0;return(null==e?void 0:e[l])?null==e?void 0:e[l]:t+n},createItemsWithUpgrades=(e,l,t)=>Array.from(Object.values(e)).reduce((e,i,r)=>{var o;let u=addStoneDataToEquip(null===n.items||void 0===n.items?void 0:n.items[i],null==l?void 0:l[r]),a="",d={...null===n.items||void 0===n.items?void 0:n.items[i],...u};return(null==d?void 0:d.UQ1txt)&&(a+=null==d?void 0:d.UQ1txt),(null==d?void 0:d.UQ2txt)&&(a+=" ".concat(null==d?void 0:d.UQ2txt)),i?[...e,{name:null===n.items||void 0===n.items?void 0:null===(o=n.items[i])||void 0===o?void 0:o.displayName,rawName:i,owner:t,..."Blank"===i?{}:{...null===n.items||void 0===n.items?void 0:n.items[i],...u},misc:a}]:e},[]),findItemInInventory=(e,l)=>l?e.reduce((e,t)=>{let{name:n,owner:i,amount:r}=t;if(n===l){var o;return null!=e&&e[i]?{...e,[i]:{amount:(null==e?void 0:null===(o=e[i])||void 0===o?void 0:o.amount)+1}}:{...e,[i]:{amount:r}}}return e},{}):{},findItemByDescriptionInInventory=(e,l)=>{if(!l)return{};let t=e.filter(e=>{var t,n;let{misc:i,description:r}=e;return(null==r?void 0:null===(t=r.toLowerCase())||void 0===t?void 0:t.includes(null==l?void 0:l.toLowerCase()))||(null==i?void 0:null===(n=i.toLowerCase())||void 0===n?void 0:n.includes(null==l?void 0:l.toLowerCase()))},[]);return null==t?void 0:t.reduce((e,l)=>{let t=null==e?void 0:e.findIndex(e=>(null==e?void 0:e.rawName)===(null==l?void 0:l.rawName)),n=null==e?void 0:e[t];if(n){var i;let r=null==n?void 0:null===(i=n.owners)||void 0===i?void 0:i.includes(null==l?void 0:l.owner),o=r?null==n?void 0:n.owners:[...null==n?void 0:n.owners,null==l?void 0:l.owner];(null==n?void 0:n.misc)===(null==l?void 0:l.misc)&&(null==e||e.splice(t,1)),e=[...e,{...l,owners:o}]}else e=[...e,{...l,owners:[null==l?void 0:l.owner]}];return e},[])},flattenCraftObject=e=>{if(!e)return[];let l={},t=JSON.parse(JSON.stringify(e)),flatten=(e,t)=>null==e?void 0:e.reduce((e,n)=>(e.push(n),n.materials&&(e=e.concat(flatten(null==n?void 0:n.materials,t)),n.materials=[]),l[null==n?void 0:n.itemName]?l[null==n?void 0:n.itemName].itemQuantity+=null==n?void 0:n.itemQuantity:l[null==n?void 0:n.itemName]=n,e),[]);return flatten(null==t?void 0:t.materials,l),Object.values(l)},findQuantityOwned=(e,l)=>{var t;let n=findItemInInventory(e,l);return null===(t=Object.entries(n))||void 0===t?void 0:t.reduce((e,l)=>{let[t,{amount:n}]=l;return{amount:(null==e?void 0:e.amount)+n,owner:[...null==e?void 0:e.owner,t]}},{amount:0,owner:[]})},addEquippedItems=(e,l)=>l?null==e?void 0:e.reduce((e,l)=>{let{tools:t,equipment:n,food:i}=l;return[...e,...t,...n,...i]},[]).filter(e=>{let{rawName:l}=e;return"Blank"!==l}).map(e=>(null==e?void 0:e.amount)?e:{...e,amount:1}):[],getAllItems=(e,l)=>{let t=null==e?void 0:e.reduce((e,l)=>{let{inventory:t=[]}=l;return[...e,...t]},[]);return[...t||[],...(null==l?void 0:l.storage)||[]]},getAllTools=()=>{var e,l,t,i,r;let o=null===n.itemsArray||void 0===n.itemsArray?void 0:null===(e=n.itemsArray.filter(e=>{let{rawName:l}=e;return null==l?void 0:l.match(/EquipmentTools[0-9]+/)}))||void 0===e?void 0:e.filter(e=>{let{rawName:l}=e;return"EquipmentTools13"!==l&&"EquipmentTools10"!==l}),u=null===n.itemsArray||void 0===n.itemsArray?void 0:null===(l=n.itemsArray.filter(e=>{let{rawName:l}=e;return null==l?void 0:l.match(/EquipmentToolsHatchet[0-9]+/)}))||void 0===l?void 0:l.filter(e=>{let{rawName:l}=e;return"EquipmentToolsHatchet0"!==l&&"EquipmentToolsHatchet3"!==l&&"EquipmentToolsHatchet11"!==l&&"EquipmentToolsHatchet10"!==l}),a=null===n.itemsArray||void 0===n.itemsArray?void 0:null===(t=n.itemsArray.filter(e=>{let{rawName:l}=e;return null==l?void 0:l.match(/FishingRod[0-9]+/)}))||void 0===t?void 0:t.filter(e=>{let{rawName:l}=e;return"FishingRod1"!==l}),d=null===n.itemsArray||void 0===n.itemsArray?void 0:null===(i=n.itemsArray.filter(e=>{let{rawName:l}=e;return null==l?void 0:l.match(/CatchingNet[0-9]+/)}))||void 0===i?void 0:i.filter(e=>{let{rawName:l}=e;return"CatchingNet1"!==l}),v=null===n.itemsArray||void 0===n.itemsArray?void 0:n.itemsArray.filter(e=>{let{rawName:l}=e;return null==l?void 0:l.match(/TrapBoxSet[0-9]+/)}),s=null===n.itemsArray||void 0===n.itemsArray?void 0:null===(r=n.itemsArray.filter(e=>{let{rawName:l}=e;return null==l?void 0:l.match(/WorshipSkull[0-9]+/)}))||void 0===r?void 0:r.filter(e=>{let{rawName:l}=e;return"WorshipSkull8"!==l});return[o,u,a,d,v,s]}}},function(e){e.O(0,[417,9774,2888,179],function(){return e(e.s=12281)}),_N_E=e.O()}]);