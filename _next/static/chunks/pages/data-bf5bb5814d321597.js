(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5081],{82374:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/data",function(){return n(67994)}])},67994:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return L}});var a=n(82729),r=n(85893),l=n(65582),o=n(15861),i=n(51233),s=n(57922),d=n(50135),c=n(23795),u=n(16628),h=n(50480),x=n(69368),p=n(56815),v=n(14564),m=n(83321),f=n(67294),g=n(56868),j=n(74721),Z=n(61599),w=n(11163),S=n(18972),b=n(31812),y=n(15765),k=e=>{let{date:t,done:n}=e,[a,l]=(0,f.useState)({days:0,hours:0,minutes:0,seconds:0});(0,f.useEffect)(()=>{l(t)},[t]);let o=()=>{let{days:e,hours:t,minutes:n,seconds:r}=a;-1==(r-=1)&&(r=59,-1==(n-=1)&&(n=59,-1==(t-=1)&&(t=0,e-=1))),l({...a,days:e,hours:t,minutes:n,seconds:r})};return(0,y.Z)(()=>{o()},1e3),(0,r.jsx)("div",{children:n?(0,r.jsx)("span",{children:"00:00:00"}):(0,r.jsxs)("span",{children:[String(a.hours).padStart(2,"0"),":",String(a.minutes).padStart(2,"0"),":",String(a.seconds).padStart(2,"0")]})})},I=n(61436),C=n(40929),T=n(24228),E=n(65116),O=n(11688),_=n(60888),N=n(2962),J=n(21596),D=n(93946),P=n(87357),U=n(54364);function z(){let e=(0,a._)(["\n  text-transform: none;\n"]);return z=function(){return e},e}let G=(0,Z.Z)(m.Z)(z()),R=e=>{let{anchorEl:t,handleClose:n}=e,a=!!t;return(0,r.jsx)(v.ZP,{sx:{ml:1},id:a?"simple-popover":void 0,open:a,anchorEl:t,onClose:n,anchorOrigin:{vertical:"center",horizontal:"right"},transformOrigin:{vertical:"center",horizontal:"left"},children:(0,r.jsx)(o.Z,{sx:{py:1,px:2},children:"Copied to clipboard!"})})};var L=()=>{var e,t,n,a;let v=(0,w.useRouter)(),{state:m}=(0,f.useContext)(O.I),[Z,y]=(0,f.useState)("all"),[z,L]=f.useState(null),[M,B]=(0,f.useState)(!1),[H,W]=(0,f.useState)(!1),[X,Y]=(0,f.useState)(!1),[q,A]=(0,f.useState)(!1),[F,Q]=(0,f.useState)(!1),[K,V]=(0,f.useState)(""),[$,ee]=(0,f.useState)(!1);(0,f.useEffect)(()=>{(null==m?void 0:m.uid)&&(W(localStorage.getItem("".concat(null==m?void 0:m.uid,"/lastUpload"))),Q("true"===localStorage.getItem("".concat(null==m?void 0:m.uid,"/leaderboardConsent"))))},[null==m?void 0:m.uid]),(0,f.useEffect)(()=>{H&&Y(144e5-(Date.now()-H)>0)},[H]);let et=async e=>{try{L(e.currentTarget),await navigator.clipboard.writeText(localStorage.getItem("rawJson"))}catch(e){console.error(e)}},en=async e=>{try{L(e.currentTarget);let t=JSON.parse(localStorage.getItem("rawJson"));await navigator.clipboard.writeText(JSON.stringify(null==t?void 0:t.data))}catch(e){console.error(e)}},ea=async()=>{let e=JSON.parse(localStorage.getItem("rawJson"));if(delete e.data.GemsOwned,delete e.data.ServerGems,delete e.data.ServerGemsReceived,delete e.data.BundlesReceived,delete e.data.GemsPacksPurchased,A(!1),!H||144e5-(Date.now()-H)<0){B(!0);try{await (0,E.UQ)({profile:e,uid:null==m?void 0:m.uid,leaderboardConsent:F},null==m?void 0:m.accessToken),A(!0);let t=Date.now();localStorage.setItem("".concat(null==m?void 0:m.uid,"/lastUpload"),t),W(t)}catch(e){V(e)}B(!1)}};return!function(e,t){let n=(0,f.useRef)(null),a=(0,f.useRef)(e);(0,f.useEffect)(()=>{a.current=e},[e]),(0,f.useEffect)(()=>{if("number"==typeof t)return n.current=window.setTimeout(()=>a.current(),t),()=>window.clearTimeout(n.current)},[t])}(()=>{L(null)},z?1e3:null),(0,r.jsxs)(l.Z,{children:[(0,r.jsx)(N.PB,{title:"Data | Idleon Toolbox",description:"Website settings and profile management"}),(0,r.jsxs)("div",{children:[(0,r.jsx)(o.Z,{variant:"h4",children:"Data"}),(0,r.jsx)(o.Z,{variant:"body1",children:"Use this when asked for data"}),(0,r.jsx)(G,{component:"span",variant:"outlined",startIcon:(0,r.jsx)(g.Z,{}),onClick:et,children:"IdleonToolbox JSON"}),(0,r.jsxs)("div",{children:[(0,r.jsxs)(i.Z,{mt:3,direction:"row",alignItems:"center",children:[(0,r.jsx)(G,{sx:{textTransform:"none",fontSize:12},variant:"outlined",startIcon:(0,r.jsx)(g.Z,{}),size:"small",onClick:en,children:"Raw Game JSON"}),(0,r.jsx)(D.Z,{onClick:()=>ee(!$),children:(0,r.jsx)(J.Z,{style:{transform:$?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.2s ease-in-out"}})})]}),(0,r.jsx)(s.Z,{in:$,children:(0,r.jsx)("div",{style:{whiteSpace:"pre-wrap",overflowWrap:"break-word"},children:JSON.stringify(JSON.parse(localStorage.getItem("rawJson")),null,2)})})]}),(0,r.jsx)(R,{anchorEl:z,handleClose:()=>L(null)})]}),(0,r.jsx)(o.Z,{variant:"h4",mt:8,children:"Local Storage"}),(0,r.jsx)(o.Z,{component:"div",variant:"caption",mb:2,color:"warning.light",children:"Use this if you're having any issues loading the website"}),(0,r.jsx)("div",{children:(0,r.jsxs)(i.Z,{direction:"row",gap:2,children:[(0,r.jsxs)(d.Z,{sx:{width:250},label:"Local storage key",select:!0,value:Z,onChange:e=>y(e.target.value),children:[(0,r.jsx)(S.Z,{value:"all",children:"All"}),(0,r.jsx)(S.Z,{value:"filters",children:"Characters page filters"}),(0,r.jsx)(S.Z,{value:"trackers",children:"Dashboard config"}),(0,r.jsx)(S.Z,{value:"planner",children:"Item Planner"}),(0,r.jsx)(S.Z,{value:"material-tracker",children:"Material tracker"}),(0,r.jsx)(S.Z,{value:"last-upload-time",children:"Last upload time"})]}),(0,r.jsx)(G,{color:"warning",variant:"outlined",onClick:()=>{"all"===Z?Object.keys(localStorage).forEach(e=>{e.includes("lastUpload")||localStorage.removeItem(e)}):"last-upload-time"===Z?(localStorage.removeItem("".concat(null==m?void 0:m.uid,"/lastUpload")),W(!1)):localStorage.removeItem(Z),v.reload()},startIcon:(0,r.jsx)(j.Z,{}),children:"Clear"})]})}),!v.query.profile&&(null==m?void 0:m.characters)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Z,{variant:"h4",mt:8,children:"Profile"}),(0,r.jsx)(o.Z,{variant:"body1",children:"* You can update your profile once every 4 hours"}),(0,r.jsx)(o.Z,{variant:"body1",mb:3,children:"* Gems and bundle information won't be saved"}),(0,r.jsxs)(o.Z,{variant:"body1",mb:3,children:["* Your profile link: ",(0,r.jsxs)(c.Z,{href:"https://idleontoolbox.com/?profile=".concat(null==m?void 0:null===(t=m.characters)||void 0===t?void 0:null===(e=t[0])||void 0===e?void 0:e.name),children:["https://idleontoolbox.com/?profile=",null==m?void 0:null===(a=m.characters)||void 0===a?void 0:null===(n=a[0])||void 0===n?void 0:n.name]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)(i.Z,{direction:"row",alignItems:"center",gap:2,children:[(0,r.jsx)(b.Z,{disabled:X,loading:M,onClick:ea,variant:"contained",children:"Upload my profile"}),(0,r.jsx)(u.Z,{in:q,children:(0,r.jsx)(_.Z,{color:"success"})})]}),(0,r.jsx)(h.Z,{control:(0,r.jsx)(x.Z,{name:"mini",checked:F,size:"small",onChange:e=>{localStorage.setItem("".concat(null==m?void 0:m.uid,"/leaderboardConsent"),!F),Q(!F)}}),label:"Participate in idleontoolbox leaderboard ranking"}),(0,r.jsx)(p.Z,{sx:{whiteSpace:"pre-wrap"},children:"Leave this box unchecked if you prefer not to participate in the leaderboard.\nTo exclude your profile, simply uncheck the box and re-upload your profile."}),(0,r.jsx)(o.Z,{sx:{mt:1},color:"error",variant:"body2",children:K}),(0,I.Z)(parseInt(H))?(0,r.jsxs)(o.Z,{sx:{mt:3},variant:"body2",children:["Last update: ",(0,C.Z)(parseInt(H),"dd/MM/yyyy HH:mm:ss")]}):null,H?(0,r.jsx)(o.Z,{variant:"body2",children:"Time to next upload"}):null,H?(0,r.jsx)(k,{done:144e5-(Date.now()-H)<0,date:(0,T.Z)({start:new Date(parseInt(H)),end:new Date().getTime()-144e5})}):null]})]}):null,$?(0,r.jsx)(P.Z,{sx:{position:"fixed",right:50,bottom:95},children:(0,r.jsx)(D.Z,{onClick:()=>{window.scrollTo({top:0,behavior:"smooth"})},size:"large",children:(0,r.jsx)(U.Z,{})})}):null]})}}},function(e){e.O(0,[5265,2888,9774,179],function(){return e(e.s=82374)}),_N_E=e.O()}]);