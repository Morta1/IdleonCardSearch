(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7196],{19920:function(e,n,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/account/misc/guild",function(){return l(57811)}])},18747:function(e,n,l){"use strict";var t=l(85893),r=l(14564),i=l(23972);l(67294),n.Z=e=>{let{anchorEl:n,handleClose:l}=e,o=!!n;return(0,t.jsx)(r.ZP,{sx:{ml:1},id:o?"simple-popover":void 0,open:o,anchorEl:n,onClose:l,anchorOrigin:{vertical:"center",horizontal:"right"},transformOrigin:{vertical:"center",horizontal:"left"},children:(0,t.jsx)(i.Z,{sx:{py:1,px:2},children:"Copied to clipboard!"})})}},89309:function(e,n,l){"use strict";var t=l(85893),r=l(87357),i=l(81458),o=l(23972);l(67294),n.Z=e=>{let{percent:n,bgColor:l,label:s=!0,sx:a,boxSx:c={},pre:d}=e;return(0,t.jsxs)(r.Z,{sx:{display:"flex",alignItems:"center",...c},children:[d,(0,t.jsx)(r.Z,{sx:{width:"100%",mr:s?1:0},children:(0,t.jsx)(i.Z,{sx:{width:"100%",height:10,borderRadius:5,"& .MuiLinearProgress-bar":{backgroundColor:l||""},...a},variant:"determinate",value:n>100?100:n})}),s?(0,t.jsx)(r.Z,{children:(0,t.jsx)(o.Z,{variant:"body2",color:"text.secondary",children:"".concat(Math.round(n),"%")})}):null]})}},30509:function(e,n,l){"use strict";var t=l(85893),r=l(67294),i=l(98396),o=l(11703),s=l(40044),a=l(30925),c=l(87357),d=l(11163);n.Z=e=>{let{tabs:n,icons:l,children:u,onTabChange:h,forceScroll:x,orientation:m="horizontal",iconsOnly:v,queryKey:p="t",clearOnChange:g=[]}=e,Z=(0,i.Z)(e=>e.breakpoints.down("md"),{noSsr:!0}),j=(0,d.useRouter)(),b=j.query[p],f=n.findIndex(e=>e===b),y=f>=0?f:0;(0,r.useEffect)(()=>{b||j.replace({pathname:j.pathname,query:{...j.query,[p]:n[y]}},void 0,{shallow:!0})},[b,p,n,y,j]);let w=Array.isArray(u)?u:[u];return(0,t.jsxs)(c.Z,{sx:"vertical"===m?{flexGrow:1,display:"flex"}:{},children:[(0,t.jsx)(o.Z,{centered:!Z||Z&&n.length<4,scrollButtons:!0,allowScrollButtonsMobile:!0,sx:{marginBottom:3},variant:Z&&n.length>=4||x?"scrollable":"standard",value:y,onChange:(e,l)=>{let t={...j.query,[p]:n[l]};g.forEach(e=>delete t[e]),j.push({pathname:j.pathname,query:t},void 0,{shallow:!0}),h&&h(l)},children:null==n?void 0:n.map((e,n)=>(0,t.jsx)(s.Z,{iconPosition:"start",icon:(null==l?void 0:l[n])?(0,t.jsx)("img",{src:"".concat(a.prefix).concat(null==l?void 0:l[n],".png")}):null,wrapped:!0,label:v?"":e,sx:{minWidth:62}},"".concat(e,"-").concat(n)))}),h?u:null==w?void 0:w.map((e,n)=>n===y?e:null)]})}},57811:function(e,n,l){"use strict";l.r(n),l.d(n,{default:function(){return guild}});var t=l(85893),r=l(2962),i=l(23972),o=l(51233),s=l(83321),a=l(66242),c=l(44267),d=l(67294),u=l(21480),h=l(30509),x=l(72882),m=l(90629),v=l(7906),p=l(53184),g=l(53816),Z=l(53252),j=l(63366),b=l(87462),f=l(94780),y=l(86010),w=l(47739),S=(0,l(88169).Z)((0,t.jsx)("path",{d:"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}),"ArrowDownward"),C=l(90948),M=l(71657),T=l(98216),E=l(1588),G=l(34867);function getTableSortLabelUtilityClass(e){return(0,G.Z)("MuiTableSortLabel",e)}let _=(0,E.Z)("MuiTableSortLabel",["root","active","icon","iconDirectionDesc","iconDirectionAsc"]),k=["active","children","className","direction","hideSortIcon","IconComponent"],useUtilityClasses=e=>{let{classes:n,direction:l,active:t}=e,r={root:["root",t&&"active"],icon:["icon",`iconDirection${(0,T.Z)(l)}`]};return(0,f.Z)(r,getTableSortLabelUtilityClass,n)},I=(0,C.ZP)(w.Z,{name:"MuiTableSortLabel",slot:"Root",overridesResolver:(e,n)=>{let{ownerState:l}=e;return[n.root,l.active&&n.active]}})(({theme:e})=>({cursor:"pointer",display:"inline-flex",justifyContent:"flex-start",flexDirection:"inherit",alignItems:"center","&:focus":{color:(e.vars||e).palette.text.secondary},"&:hover":{color:(e.vars||e).palette.text.secondary,[`& .${_.icon}`]:{opacity:.5}},[`&.${_.active}`]:{color:(e.vars||e).palette.text.primary,[`& .${_.icon}`]:{opacity:1,color:(e.vars||e).palette.text.secondary}}})),L=(0,C.ZP)("span",{name:"MuiTableSortLabel",slot:"Icon",overridesResolver:(e,n)=>{let{ownerState:l}=e;return[n.icon,n[`iconDirection${(0,T.Z)(l.direction)}`]]}})(({theme:e,ownerState:n})=>(0,b.Z)({fontSize:18,marginRight:4,marginLeft:4,opacity:0,transition:e.transitions.create(["opacity","transform"],{duration:e.transitions.duration.shorter}),userSelect:"none"},"desc"===n.direction&&{transform:"rotate(0deg)"},"asc"===n.direction&&{transform:"rotate(180deg)"})),N=d.forwardRef(function(e,n){let l=(0,M.Z)({props:e,name:"MuiTableSortLabel"}),{active:r=!1,children:i,className:o,direction:s="asc",hideSortIcon:a=!1,IconComponent:c=S}=l,d=(0,j.Z)(l,k),u=(0,b.Z)({},l,{active:r,direction:s,hideSortIcon:a,IconComponent:c}),h=useUtilityClasses(u);return(0,t.jsxs)(I,(0,b.Z)({className:(0,y.Z)(h.root,o),component:"span",disableRipple:!0,ownerState:u,ref:n},d,{children:[i,a&&!r?null:(0,t.jsx)(L,{as:c,className:(0,y.Z)(h.icon),ownerState:u})]}))});var A=l(295),D=l(30925),P=l(87357),R=l(40929),Guild_GuildMembers=e=>{let{members:n,saves:l}=e,[r,o]=(0,d.useState)(),[s,a]=(0,d.useState)("desc"),[c,u]=(0,d.useState)("gpEarned");(0,d.useEffect)(()=>{o(getSortedMembers(n,c,s))},[n]);let getSortedMembers=(e,n,l)=>e.sort((e,t)=>"asc"===l?(null==e?void 0:e[n])-(null==t?void 0:t[n]):(null==t?void 0:t[n])-(null==e?void 0:e[n])),handleSort=(e,l)=>{a(l),u(e);let t=getSortedMembers(n,e,l);o(t)};return(0,t.jsx)(x.Z,{component:m.Z,children:(0,t.jsxs)(v.Z,{children:[(0,t.jsxs)(p.Z,{children:[(0,t.jsxs)(g.Z,{children:[(0,t.jsx)(Z.Z,{children:"Name"}),(0,t.jsx)(Z.Z,{sortDirection:s,children:(0,t.jsx)(N,{direction:s,active:"level"===c,onClick:()=>handleSort("level","asc"===s?"desc":"asc"),children:"Level"})}),(0,t.jsx)(Z.Z,{sortDirection:s,align:(null==l?void 0:l.length)===0?"left":"center",colSpan:(null==l?void 0:l.length)||1,children:(0,t.jsx)(N,{direction:s,active:"gpEarned"===c,onClick:()=>handleSort("gpEarned","asc"===s?"desc":"asc"),children:"Earned GP"})}),(0,t.jsx)(Z.Z,{children:"Wanted Bonus"})]}),(null==l?void 0:l.length)>0?(0,t.jsxs)(g.Z,{children:[(0,t.jsx)(Z.Z,{colSpan:2}),null==l?void 0:l.map((e,n)=>{if(e)return(0,t.jsx)(Z.Z,{children:(0,R.Z)(null==e?void 0:e.timestamp,"dd/MM/yyyy HH:mm:ss")},(null==e?void 0:e.timestamp)+n)}),(0,t.jsx)(Z.Z,{})]}):null]}),(0,t.jsx)(A.Z,{children:null==r?void 0:r.map((e,n)=>{let{name:r,level:o,gpEarned:s,wantedBonus:a,rank:c}=e,d=null==l?void 0:l.reduce((e,n)=>{var l;let t=null==n?void 0:null===(l=n.members)||void 0===l?void 0:l.find(e=>{let{name:n}=e;return n===r});return[...e,{gpChange:t?s-(null==t?void 0:t.gpEarned):s,timestamp:null==n?void 0:n.timestamp}]},[]);return r?(0,t.jsxs)(g.Z,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,t.jsxs)(Z.Z,{children:[c<5?(0,t.jsx)("img",{src:"".concat(D.prefix,"etc/GuildRank").concat(c,".png"),alt:"rank-".concat(c)}):(0,t.jsx)(P.Z,{component:"span",sx:{display:"inline-block",width:15,height:17}}),(0,t.jsxs)(i.Z,{component:"span",sx:{ml:1},children:[r," ",0===c?"(King)":1===c?"(Leader)":""]})]}),(0,t.jsx)(Z.Z,{children:o}),(null==l?void 0:l.length)===0?(0,t.jsx)(Z.Z,{children:s}):null,d.map((e,n)=>{let{gpChange:l}=e;return(0,t.jsxs)(Z.Z,{children:[(0,t.jsx)(i.Z,{component:"span",mr:1,children:s}),(0,t.jsxs)(i.Z,{variant:"caption",color:l>0?"success.light":"error.light",children:["(",l>0?"+":"",l,")"]})]},"change"+n)}),(0,t.jsx)(Z.Z,{children:(0,D.cleanUnderscore)(null==a?void 0:a.name)||"Guild Gifts"})]},r+o+n):null})})]})})},Guild_GuildBonuses=e=>{let{bonuses:n}=e,getCostToMax=e=>{let{maxLevel:n,level:l,gpBaseCost:t,gpIncrease:r}=e,i=0;for(let e=l;e<n;e++)i+=t+e*r;return i};return(0,t.jsx)(o.Z,{direction:"row",flexWrap:"wrap",gap:2,children:null==n?void 0:n.map((e,n)=>{let{name:l,level:r,gpIncrease:s,maxLevel:d,bonus:u,func:h,x1:x,x2:m,gpBaseCost:v}=e,p=getCostToMax(e);return(0,t.jsx)(a.Z,{sx:{width:300},children:(0,t.jsx)(c.Z,{children:(0,t.jsxs)(o.Z,{gap:2,children:[(0,t.jsxs)(o.Z,{direction:"row",alignItems:"center",gap:2,children:[(0,t.jsx)("img",{src:"".concat(D.prefix,"data/Gbonus").concat(n,".png"),alt:""}),(0,t.jsx)(i.Z,{children:(0,D.cleanUnderscore)(l)})]}),(0,t.jsxs)(o.Z,{gap:1,children:[(0,t.jsxs)(i.Z,{children:["level: ",r," / ",d]}),(0,t.jsxs)(i.Z,{children:["Cost: ",(0,D.notateNumber)(v+r*s)]}),(0,t.jsxs)(i.Z,{children:["Cost To Max: ",(0,D.notateNumber)(p)]}),(0,t.jsx)(i.Z,{sx:{fontSize:16},children:(0,D.cleanUnderscore)(u.replace("{",(0,D.growth)(h,r,x,m)))})]})]})})},l+n)})})},B=l(89309),O=l(18747);let CardTitleAndValue=e=>{let{cardSx:n,title:l,value:r,children:o}=e;return(0,t.jsx)(a.Z,{sx:{my:{xs:0,md:3},width:"fit-content",...n},children:(0,t.jsxs)(c.Z,{children:[(0,t.jsx)(i.Z,{sx:{fontSize:14},color:"text.secondary",gutterBottom:!0,children:l}),r?(0,t.jsx)(i.Z,{children:r}):o]})})};var guild=()=>{var e,n,l,a,c,x,m,v;let{state:p}=(0,d.useContext)(u.I),{guild:g}=null==p?void 0:p.account,[Z,j]=(0,d.useState)([]),[b,f]=d.useState(null),[y,w]=(0,d.useState)("");(0,d.useEffect)(()=>{let e=(0,D.tryToParse)(localStorage.getItem("guild"));e&&j(Array.isArray(e)?e:[e])},[]);let exportToJson=async e=>{f(e.currentTarget);try{var n;let e={date:(0,R.Z)(new Date,"dd/MM/yyyy HH:mm:ss"),members:null==g?void 0:null===(n=g.members)||void 0===n?void 0:n.map(e=>{let{name:n,gpEarned:l}=e;return{name:n,gpEarned:l}})};await navigator.clipboard.writeText(JSON.stringify(e,null,2))}catch(e){console.error("exportToJson -> ",e)}};return g&&(null==g?void 0:null===(e=g.members)||void 0===e?void 0:e.length)!==0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.PB,{title:"Guild | Idleon Toolbox",description:"Keep track of your guild members, gp, bonuses and more"}),(0,t.jsxs)(o.Z,{children:[(0,t.jsxs)(o.Z,{direction:"row",alignItems:"center",gap:1,children:[(0,t.jsx)("img",{src:"".concat(D.prefix,"data/G2icon").concat(null==p?void 0:null===(l=p.account)||void 0===l?void 0:null===(n=l.accountOptions)||void 0===n?void 0:n[38],".png"),alt:"guild-icon"}),(0,t.jsxs)(i.Z,{variant:"h3",children:[null==p?void 0:null===(c=p.account)||void 0===c?void 0:null===(a=c.accountOptions)||void 0===a?void 0:a[37]," ",(0,t.jsxs)(i.Z,{component:"span",variant:"h5",children:["(",null==g?void 0:null===(x=g.members)||void 0===x?void 0:x.length," / ",null==g?void 0:g.maxMembers,")"]})]})]}),(0,t.jsxs)(o.Z,{sx:{mb:1},direction:"row",gap:2,flexWrap:"wrap",children:[(0,t.jsx)(CardTitleAndValue,{title:"Members",value:"".concat(null==g?void 0:null===(m=g.members)||void 0===m?void 0:m.length," / ").concat(null==g?void 0:g.maxMembers)}),(0,t.jsxs)(CardTitleAndValue,{title:"Exp",children:[(0,t.jsx)(B.Z,{boxSx:{width:200},percent:(null==g?void 0:g.totalGp)/Math.round(null==g?void 0:g.levelReq)*100,bgColor:"#f3dd4c"}),(0,t.jsxs)(i.Z,{children:[(0,D.numberWithCommas)(null==g?void 0:g.totalGp)," / ",(0,D.numberWithCommas)(Math.round(null==g?void 0:g.levelReq))]})]}),(0,t.jsx)(CardTitleAndValue,{title:"Saves (up to 3)",children:(0,t.jsxs)(o.Z,{gap:1,children:[(0,t.jsx)(P.Z,{children:null==Z?void 0:null===(v=Z.reverse())||void 0===v?void 0:v.map((e,n)=>{let{timestamp:l}=e;return(0,t.jsxs)(i.Z,{children:["#",n+1," - ",(0,R.Z)(new Date(l),"dd/MM/yyyy HH:mm:ss")]},l+n)})}),(0,t.jsxs)(o.Z,{direction:"row",alignItems:"center",gap:2,children:[(0,t.jsx)(s.Z,{variant:"contained",onClick:()=>{let e;let n=new Date().getTime(),l=(0,D.tryToParse)(localStorage.getItem("guild"));j(e=Array.isArray(l)?[...(l=(null==l?void 0:l.length)>=3?null==l?void 0:l.slice(1):l)||[],{timestamp:n,members:null==g?void 0:g.members}]:l?[l,{timestamp:n,members:null==g?void 0:g.members}]:[{timestamp:n,members:null==g?void 0:g.members}]),localStorage.setItem("guild",JSON.stringify(e)),w("")},children:"Save"}),(0,t.jsx)(s.Z,{variant:"contained",onClick:exportToJson,children:"Export"}),(0,t.jsx)(O.Z,{anchorEl:b,handleClose:()=>f(null)}),(0,t.jsx)(s.Z,{variant:"contained",color:"warning",onClick:()=>{localStorage.removeItem("guild"),j([])},children:"Clear all"})]}),y?(0,t.jsx)(i.Z,{color:"error.light",children:y}):null]})})]})]}),(0,t.jsxs)(h.Z,{tabs:["Members","Bonuses"],children:[(0,t.jsx)(Guild_GuildMembers,{members:null==g?void 0:g.members,saves:Z}),(0,t.jsx)(Guild_GuildBonuses,{bonuses:null==g?void 0:g.guildBonuses})]})]}):(0,t.jsx)(i.Z,{variant:"h3",mb:3,children:"You have to be in a guild to view this page's content"})}}},function(e){e.O(0,[2307,9774,2888,179],function(){return e(e.s=19920)}),_N_E=e.O()}]);